---
title: "DesignProject"
author: "Michelle Nesbit"
date: "2022-11-16"
output: html_document
---
2^4 factorial experimental design
beyblades
A) stadium (a surface it spins on) (grey is low, blue is high)
B) launcher (ripcord tool that starts it spinning) (white is low, black is high)
C) beyblade (spinning top toy) (dark red is low, light red is high)
D) mode (mode 1 is low, mode 2 is high)

We are confounding ABCD interaction within blocks, so that L = x1+x2+x3+x4 (mod 2)
will be 0 if {x1,x2,x3,x4} contains 0, 2, or 4 ones: (1), ab, ac, ad, bc, bd,
cd, abcd, and 1 otherwise

randomize draws
enter data
check dfs
visually look for significant factors
reduce model
run anova
check model assumptions
post hoc?
additional research that could be done?

We need to randomize runs within the blocks

```{r}
A <- as.factor(rep(c(-1,1), times=8))
B <- as.factor(rep(c(-1,1), each = 2, times=4))
C <- as.factor(rep(c(-1,1), each = 4, times=2))
D <- as.factor(rep(c(-1,1), each = 8))
blocks<-as.factor(rep(c(1,2), each=8))
#ABCD-:(1), ab, ab, bc, ad, bd, cd, abcd  
#ABCD+: a, b , c, abc, d, abd, acd, bcd
Bl1 <- c('(1)', 'ab', 'ac', 'bc', 'ad', 'bd', 'cd', 'abcd')
Bl2<- c('a', 'b' , 'c', 'abc', 'd', 'abd', 'acd', 'bcd')

#randomly sample from each block
set.seed(2022)
block1_runs <- sample(Bl1,size=8,replace=F)
#bc, ac, bd, cd, abcd, ab, (1), ad
set.seed(2022)
block2_runs <- sample(Bl2,size=8,replace=F)
#abc, c, abd, acd, bcd, b, a, d

#input data
bl1_spins <- c(62.98,75.72,23.98,83.58,108.11,24.00,24.77,4.31)
bl2_spins <- c(83.80,98.16,31.34,69.39,81.41,24.04,69.87,54.51)

y <- c(Bl1, Bl2)

beydata <- data.frame(A, B, C, D, y, blocks)

beymod <- lm(y ~ ((A+B+C+D)^4+blocks), data=beydata)
anova(beymod) 

#Visualize effects looks like ____ could be significant
beymod$effects
beymod.effects <- abs(beymod$effects[-1])

qq <- qqnorm(beymod.effects, type="n")  
text(qq$x, qq$y, labels = names(beymod$effects))

# Run Anova
beymod2 <- lm(y ~ ((A+B+C+D)^4+blocks), data=beydata)
anova(beymod2) 

# We find ____ to be significant factors. Will remove others and rerun ANOVA.
beymod3<-lm(y~A+B+C+D+A*B+A*C+A*B*C, data=beydata)
anova(beymod3)

#effect estimates
beymod3$coefficients

# assumption tests
# residual analysis via normal plot: looks mostly normal, some head/tail
par(mfrow=c(1,2))
qqnorm(beymod3$residuals)
qqline(beymod3$residuals)
#testing assumptions
# we fail to reject normality or homoscedasticity of any main factors
shapiro.test(beymod3$residuals) 
bartlett.test(beymod3$residuals~A)
bartlett.test(beymod3$residuals~B)
bartlett.test(beymod3$residuals~C)
bartlett.test(beymod3$residuals~D)
```
```
Data
```{r}

```



```{r}

```

